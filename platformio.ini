[env:attiny202]
platform = atmelmegaavr@1.9.0
board = attiny202

; Clock configuration
board_build.f_cpu = 20000000L

; Build minimal version only
build_src_filter =
    +<*>
    -<main.cpp>
    -<main_test.cpp>
    -<level_logic.cpp>
    -<alert_manager.cpp>
    -<button.cpp>
    -<eeprom_config.cpp>
    +<main_minimal.cpp>

; Compiler flags for size optimization
build_flags =
    -Os                    ; Optimize for size
    -flto                  ; Link-time optimization
    -ffunction-sections    ; Each function in its own section
    -fdata-sections        ; Each data in its own section
    -Wall                  ; All warnings
    -Wextra                ; Extra warnings
    -fno-exceptions        ; No C++ exceptions
    -fno-rtti              ; No runtime type info
    -fno-threadsafe-statics ; No thread-safe statics
    -Wl,--gc-sections      ; Garbage collect unused sections
    -Wl,--relax            ; Linker relaxation
    -mcall-prologues       ; Use call prologues for function entry/exit

; Linker flags
build_unflags =
    -fno-lto

extra_scripts =

; Upload configuration for UPDI
upload_protocol = serialupdi
upload_speed = 115200
upload_flags =
    -P$UPLOAD_PORT

; Monitor (if available)
monitor_speed = 9600

; Dependencies
lib_deps =

; ============================================
; ATtiny202 Test Bench - Simulated Sensors
; ============================================
[env:attiny202_test]
platform = atmelmegaavr@1.9.0
board = attiny202

; Clock configuration
board_build.f_cpu = 20000000L

; Build test version only
build_src_filter =
    +<*>
    -<main.cpp>
    -<main_minimal.cpp>
    -<level_logic.cpp>
    -<alert_manager.cpp>
    -<button.cpp>
    -<eeprom_config.cpp>
    -<twi.cpp>
    -<fdc1004.cpp>
    +<main_test.cpp>

; Compiler flags for size optimization
build_flags =
    -Os
    -flto
    -ffunction-sections
    -fdata-sections
    -Wall
    -Wextra
    -fno-exceptions
    -fno-rtti
    -fno-threadsafe-statics
    -Wl,--gc-sections
    -Wl,--relax
    -mcall-prologues

build_unflags =
    -fno-lto

; Upload configuration for UPDI
upload_protocol = serialupdi
upload_speed = 115200
upload_flags =
    -P$UPLOAD_PORT

lib_deps =

; ============================================
; ATtiny402 (4KB Flash) - Full Features
; ============================================
[env:attiny402]
platform = atmelmegaavr@1.9.0
board = attiny402

; Clock configuration
board_build.f_cpu = 20000000L

; Build full version with all features
build_src_filter =
    +<*>
    -<main_minimal.cpp>
    -<main_test.cpp>

; Compiler flags for size optimization
build_flags =
    -Os
    -flto
    -ffunction-sections
    -fdata-sections
    -Wall
    -Wextra
    -fno-exceptions
    -fno-rtti
    -fno-threadsafe-statics
    -Wl,--gc-sections
    -Wl,--relax
    -mcall-prologues

build_unflags =
    -fno-lto

; Upload configuration for UPDI
upload_protocol = serialupdi
upload_speed = 115200
upload_flags =
    -P$UPLOAD_PORT

lib_deps =
